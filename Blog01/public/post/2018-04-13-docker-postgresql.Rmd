---
title: Docker PostGreSQL
author: DannyJRa
date: '2018-04-13'
slug: docker-postgresql
categories:
  - R
tags:
  - Docker
hidden: false
image: "img/cover.jpg"
blogdown::html_page:
  toc: true
  fig_width: 6
  dev: "svg"
  code_folding: true
---

# Docker: PostgreSQL 10 and pgAdmin 4

## Run Docker with PostgreSQL container

Make persistent volume to store config files and database files:

>mkdir -p $HOME/docker/volumes/postgres

Rund docker command to create postgresql database with User: postgres and POSTGRES_PASSWORD=docker:
# Exucute postgresql 



>docker run --rm   --name pg-docker -e POSTGRES_PASSWORD=docker -d -p 5434:5432 -v $HOME/docker/volumes/postgres:/var/lib/postgresql/data  postgres

## Connect to Postgres

Once the container is up an running, connecting to it from an application is no different than connecting to a Postgres instance running outside a docker container. For example, to connect using psql we can execute[^1]

>psql -h localhost -U postgres -d postgres

### Access postgresql.conf file

{{< yt w7Ft2ymGmfc >}}

Switch to root 
>sudo su


And access the conf file to manage e.g. remote access to the database:

>/home/danny/docker/volumes/postgres# sudo nano postgresql.conf


### Open port

If you work on the google cloud, you can open the port=5434 for all instances in the current workind directory with:

>gcloud compute firewall-rules create postgresdocker --allow tcp:5434 \
      --description "Allow incoming traffic on TCP port 5434" \
      --direction INGRESS

      
##  Run Docker with pgAdmin 4 container

Pull and start the pgAdmin container:




```{bash, eval=F, include=T}
docker run -p 5051:5051 \
        -e "PGADMIN_DEFAULT_EMAIL=${S_email}" \
        -e "PGADMIN_DEFAULT_PASSWORD=${S_pwd_pgadmin}" \
        -e "PGADMIN_LISTEN_PORT=5051" \
        -d dpage/pgadmin4
```

>docker run -p 5050:5050 \
        -e "PGADMIN_DEFAULT_EMAIL=xxxoutlook.com" \
        -e "PGADMIN_DEFAULT_PASSWORD=secretpassword" \
        -e "PGADMIN_LISTEN_PORT=5050" \
        -d dpage/pgadmin4 \
        -v "/home/danny/docker/volumes/pgadmin:/var/lib/pgadmin/shared"

Problem: Not yet solved the issue that the volume will not be shared currently

       
### Open port 5050 


>gcloud compute firewall-rules create vscode --allow tcp:80 \
      --description "Allow incoming traffic on TCP port 80" \
      --direction INGRESS
 
{{< tweet 817461069014859780 >}}

$\int_0^\infty f(x) dx$

List all firewall rules:

>gcloud compute firewall-rules list

Then login with your set credentials at port 5050 (in this case):
![Login](pgAdmin_login.png) 

{{< instagram BWNjjyYFxVx >}}
        
rterte

```{r echo=FALSE}
blogdown::shortcode('tweet', '852205086956818432')
```


***
[^1]: Adopted from https://hackernoon.com/dont-install-postgres-docker-pull-postgres-bee20e200198