---
title: Docker PostGreSQL
author: DannyJRa
date: '2018-04-13'
slug: docker-postgresql
categories:
  - R
tags:
  - Docker
hidden: false
image: "img/cover.jpg"
blogdown::html_page:
  toc: true
  fig_width: 6
  dev: "svg"
  code_folding: true
---



<div id="docker-postgresql-10-and-pgadmin-4" class="section level1">
<h1>Docker: PostgreSQL 10 and pgAdmin 4</h1>
<div id="run-docker-with-postgresql-container" class="section level2">
<h2>Run Docker with PostgreSQL container</h2>
<p>Make persistent volume to store config files and database files:</p>
<blockquote>
<p>mkdir -p $HOME/docker/volumes/postgres</p>
</blockquote>
<p>Rund docker command to create postgresql database with User: postgres and POSTGRES_PASSWORD=docker:
# Exucute postgresql</p>
<blockquote>
<p>docker run –rm –name pg-docker -e POSTGRES_PASSWORD=docker -d -p 5434:5432 -v $HOME/docker/volumes/postgres:/var/lib/postgresql/data postgres</p>
</blockquote>
</div>
<div id="connect-to-postgres" class="section level2">
<h2>Connect to Postgres</h2>
<p>Once the container is up an running, connecting to it from an application is no different than connecting to a Postgres instance running outside a docker container. For example, to connect using psql we can execute<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<blockquote>
<p>psql -h localhost -U postgres -d postgres</p>
</blockquote>
<div id="access-postgresql.conf-file" class="section level3">
<h3>Access postgresql.conf file</h3>
<p>{{&lt; yt w7Ft2ymGmfc &gt;}}</p>
<p>Switch to root
&gt;sudo su</p>
<p>And access the conf file to manage e.g. remote access to the database:</p>
<blockquote>
<p>/home/danny/docker/volumes/postgres# sudo nano postgresql.conf</p>
</blockquote>
</div>
<div id="open-port" class="section level3">
<h3>Open port</h3>
<p>If you work on the google cloud, you can open the port=5434 for all instances in the current workind directory with:</p>
<blockquote>
<p>gcloud compute firewall-rules create postgresdocker –allow tcp:5434<br />
–description “Allow incoming traffic on TCP port 5434”<br />
–direction INGRESS</p>
</blockquote>
</div>
</div>
<div id="run-docker-with-pgadmin-4-container" class="section level2">
<h2>Run Docker with pgAdmin 4 container</h2>
<p>Pull and start the pgAdmin container:</p>
<pre class="bash"><code>docker run -p 5051:5051 \
        -e &quot;PGADMIN_DEFAULT_EMAIL=${S_email}&quot; \
        -e &quot;PGADMIN_DEFAULT_PASSWORD=${S_pwd_pgadmin}&quot; \
        -e &quot;PGADMIN_LISTEN_PORT=5051&quot; \
        -d dpage/pgadmin4</code></pre>
<blockquote>
<p>docker run -p 5050:5050<br />
-e “PGADMIN_DEFAULT_EMAIL=xxxoutlook.com”<br />
-e “PGADMIN_DEFAULT_PASSWORD=secretpassword”<br />
-e “PGADMIN_LISTEN_PORT=5050”<br />
-d dpage/pgadmin4<br />
-v “/home/danny/docker/volumes/pgadmin:/var/lib/pgadmin/shared”</p>
</blockquote>
<p>Problem: Not yet solved the issue that the volume will not be shared currently</p>
<div id="open-port-5050" class="section level3">
<h3>Open port 5050</h3>
<blockquote>
<p>gcloud compute firewall-rules create vscode –allow tcp:80<br />
–description “Allow incoming traffic on TCP port 80”<br />
–direction INGRESS</p>
</blockquote>
<p>{{&lt; tweet 817461069014859780 &gt;}}</p>
<p><span class="math inline">\(\int_0^\infty f(x) dx\)</span></p>
<p>List all firewall rules:</p>
<blockquote>
<p>gcloud compute firewall-rules list</p>
</blockquote>
<p>Then login with your set credentials at port 5050 (in this case):
<img src="pgAdmin_login.png" alt="Login" /></p>
<p>{{&lt; instagram BWNjjyYFxVx &gt;}}</p>
<p>rterte</p>
{{% tweet "852205086956818432" %}}
<hr />
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Adopted from <a href="https://hackernoon.com/dont-install-postgres-docker-pull-postgres-bee20e200198" class="uri">https://hackernoon.com/dont-install-postgres-docker-pull-postgres-bee20e200198</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
